<story-context id="epic-16/story-16-1" v="1.0">
  <metadata>
    <epicId>16</epicId>
    <storyId>16.1</storyId>
    <title>Quality Score Dashboard</title>
    <status>ready-for-dev</status>
    <generatedAt>2025-12-14</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/16-1-quality-score-dashboard.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Leader</asA>
    <iWant>quality score cho mỗi post/video</iWant>
    <soThat>tôi biết content nào cần cải thiện</soThat>
    <tasks>
      <backend>
        <task>Create ContentQualityService with calculateQualityScore method</task>
        <task>Define quality factors and weights</task>
        <task>Add quality list and trends endpoints</task>
        <task>Add improvement highlights</task>
      </backend>
      <frontend>
        <task>Create QualityScoreCard component</task>
        <task>Create QualityContentList component</task>
        <task>Create QualityTrendChart component</task>
        <task>Create Quality Dashboard page</task>
      </frontend>
    </tasks>
  </story>

  <acceptanceCriteria>
    <criterion id="1">Given content metrics, When user xem quality dashboard, Then hiển thị overall score 0-100 với breakdown</criterion>
    <criterion id="2">Given quality score breakdown, When user xem details, Then hiển thị scores cho: engagement, watch time, compliance</criterion>
    <criterion id="3">Given multiple content items, When user xem dashboard, Then hiển thị list sorted by quality score</criterion>
    <criterion id="4">Given quality trends, When user xem dashboard, Then hiển thị quality trend over time</criterion>
    <criterion id="5">Given low quality content, When user xem details, Then highlight areas needing improvement</criterion>
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc path="docs/epics.md" section="Epic-16">Epic 16 definition</doc>
      <doc path="docs/research/feature-improvement-proposals.md" section="Epic-16">Research</doc>
    </docs>
    <code>
      <existingPatterns>
        <pattern path="libraries/nestjs-libraries/src/database/prisma/themes/">Service patterns</pattern>
        <pattern path="apps/backend/src/api/routes/">Controller patterns</pattern>
      </existingPatterns>
      <newFiles>
        <file>libraries/nestjs-libraries/src/database/prisma/quality/content-quality.service.ts</file>
        <file>apps/backend/src/api/routes/quality.controller.ts</file>
        <file>apps/frontend/src/components/quality/quality-score-card.tsx</file>
        <file>apps/frontend/src/app/(app)/(site)/quality/page.tsx</file>
      </newFiles>
    </code>
  </artifacts>

  <interfaces>
    <api>
      <endpoint method="GET" path="/api/quality/score/:contentId">Get single content quality score</endpoint>
      <endpoint method="GET" path="/api/quality/list">Get content list by quality</endpoint>
      <endpoint method="GET" path="/api/quality/trends">Get quality trends</endpoint>
    </api>
    <dataModels>
      <model name="QualityScore">
        <field name="overallScore" type="number">0-100</field>
        <field name="engagementScore" type="number">Engagement quality</field>
        <field name="watchTimeScore" type="number">Watch time quality</field>
        <field name="complianceScore" type="number">Policy compliance</field>
        <field name="consistencyScore" type="number">Posting consistency</field>
        <field name="improvements" type="array">Areas to improve</field>
      </model>
    </dataModels>
  </interfaces>

  <qualityFactors>
    <factor name="engagement" weight="35">Likes, comments, shares relative to reach</factor>
    <factor name="watchTime" weight="25">Average view duration, completion rate</factor>
    <factor name="compliance" weight="25">Policy adherence, no bait</factor>
    <factor name="consistency" weight="15">Regular posting, brand alignment</factor>
  </qualityFactors>

  <scoreInterpretation>
    <range min="80" max="100">Excellent quality</range>
    <range min="60" max="79">Good quality</range>
    <range min="40" max="59">Average, needs improvement</range>
    <range min="0" max="39">Poor quality, action required</range>
  </scoreInterpretation>
</story-context>
